---
title: 为什么(byte)128等于-128？
date: 2016-10-15 11:55:06
tags:
---

最近在写 Java 程序的时候遇到个问题，打印`(byte)128`的结果居然是`-128`，这是为什么呢？于是上网搜寻了一番，发现很多都是大学学的计算机基础课程，当时背背就考试通过了，理解的也不算透彻，于是就此记录一下。

## 机器数

一个数在计算机中的二进制表示形式,  叫做这个数的机器数。机器数是带符号的，在计算机用一个数的最高位存放符号, 正数为`0`, 负数为`1`。

比如，十进制中的数 `+3` ，计算机字长为8位，转换成二进制就是`00000011`。如果是 `-3` ，就是 `10000011` 。

那么，这里的 `00000011` 和 `10000011` 就是机器数

## 真值

因为第一位是符号位，所以机器数的形式值就不等于真正的数值。例如上面的有符号数 `10000011`，其最高位`1`代表负，其真正数值是 `-3` 而不是形式值`131`（`10000011`转换成十进制等于`131`）。所以，为区别起见，将带符号位的机器数对应的真正数值称为机器数的真值。

例：`0000 0001`的真值 = `+000 0001` = `+1`，`1000 0001`的真值 = `–000 0001` = `-1`

## 原码

原码就是符号位加上真值的绝对值, 即用第一位表示符号, 其余位表示值. 比如如果是8位二进制:

	[+1]原 = 0000 0001
	
	[-1]原 = 1000 0001

第一位是符号位. 因为第一位是符号位, 所以8位二进制数的取值范围就是 [1111 1111 , 0111 1111] 即 [-127 , 127]

## 反码

正数的反码是其本身。

负数的反码是在其原码的基础上, 符号位不变，其余各个位取反。

	[+1] = [00000001]原 = [00000001]反
	
	[-1] = [10000001]原 = [11111110]反

可见如果一个反码表示的是负数, 人脑无法直观的看出来它的数值. 通常要将其转换成原码再计算
## 补码

正数的补码就是其本身

负数的补码是在其原码的基础上, 符号位不变, 其余各位取反, 最后+1. (即在反码的基础上+1)

	[+1] = [00000001]原 = [00000001]反 = [00000001]补
	
	[-1] = [10000001]原 = [11111110]反 = [11111111]补

对于负数, 补码表示方式也是人脑无法直观看出其数值的. 通常也需要转换成原码在计算其数值


## 为何要使用原码, 反码和补码？

**人们发明了"原码"，把生活应该有的正负概念，原原本本的表示出来**
把左边第一位腾出位置，存放符号，正用`0`来表示，负用`1`来表示
我们希望 `+1` 和 `-1` 相加是 `0`，但计算机只能算出`0001+1001=1010 (-2)`,这不是我们想要的结果。

**为了解决“正负相加等于0”的问题，在“原码”的基础上，人们发明了“反码”**“反码”表示方式是用来处理负数的，符号位置不变，其余位置相反过去的`+1`和`-1`相加，变成了`0001+1110=1111`，刚好反码表示方式中，`1111`象征`-0`。


人们总是进益求精，历史遗留下来的问题—— 有两个零存在，`+0` 和 `-0`，**我们希望只有一个0，所以发明了"补码"**，同样是针对"负数"做处理的，"补码"的意思是，从原来"反码"的基础上加`1`
有得必有失，在补一位`1`的时候，要丢掉最高位。我们要处理"反码"中的`-0`,当`1111`再补上一个`1`之后，变成了`10000`，丢掉最高位就是`0000`，刚好和左边正数的`0`，完美融合掉了，这样就解决了`+0`和`-0`同时存在的问题，另外"正负数相加等于0"的问题，同样得到满足。

举例，`3`和`-3`相加，`0011 + 1101 =10000`，丢掉最高位，就是`0000（0）`

## 为什么(byte)128等于 -128？

我们知道，在计算机系统中，数值一律用[补码](http://baike.baidu.com/view/377340.htm)来表示和存储。Java中，`byte`数据类型是`8`位、有符号的，以二进制补码表示的整数，`int`数据类型是`32`位、有符号的以二进制补码表示的整数。`128`是一个`int`类型整数 `00000000 00000000 00000000 10000000`，长度为`32`位，强制转换为`byte`后最后`8`位为`10000000`，首位是`1`，Java认为是负数的补码标识，结果为`-128`

参考资料：

[原码, 反码, 补码 详解](http://www.cnblogs.com/zhangziqiu/archive/2011/03/30/ComputerCode.html#!comments)  
[原码、反码、补码的产生、应用以及优缺点有哪些？](https://www.zhihu.com/question/20159860)  
[补码10000000为什么可以表示-128？](https://www.zhihu.com/question/28685048)  